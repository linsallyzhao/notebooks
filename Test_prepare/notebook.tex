
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{TEST}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{tsa}\PY{n+nn}{.}\PY{n+nn}{stattools} \PY{k}{import} \PY{n}{adfuller}
        \PY{k+kn}{from} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{tsa}\PY{n+nn}{.}\PY{n+nn}{stattools} \PY{k}{import} \PY{n}{kpss}
        \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{as} \PY{n+nn}{stats}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/home/lin/.pyenv/versions/3.6.3/lib/python3.6/site-packages/statsmodels/compat/pandas.py:56: FutureWarning: The pandas.core.datetools module is deprecated and will be removed in a future version. Please use the pandas.tseries module instead.
  from pandas.core import datetools

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{my\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/home/lin/教材/Financial\PYZus{}data/FinalTest/Dataset.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{my\PYZus{}data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}3}]:}       S1     S2     S3
        0  42.10  23.80  46.05
        1  44.20  23.80  45.92
        2  44.94  23.57  46.14
        3  44.86  23.58  46.07
        4  43.64  23.29  44.09
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{logR} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{my\PYZus{}data}\PY{p}{)}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \hypertarget{q-1}{%
\subsection{Q 1}\label{q-1}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{logR}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:}                 S1           S2           S3
         count  2499.000000  2499.000000  2499.000000
         mean      0.000206    -0.000182    -0.000565
         std       0.045696     0.031346     0.054522
\end{Verbatim}
            
    \hypertarget{skewness-for-three-stocks}{%
\subsection{Skewness for three stocks}\label{skewness-for-three-stocks}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{stats}\PY{o}{.}\PY{n}{skew}\PY{p}{(}\PY{n}{logR}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} array([-3.73482945e-03, -4.64590384e+00, -5.24419564e-01])
\end{Verbatim}
            
    \hypertarget{kurtosis-for-three-stocks}{%
\subsection{Kurtosis for three stocks}\label{kurtosis-for-three-stocks}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{stats}\PY{o}{.}\PY{n}{kurtosis}\PY{p}{(}\PY{n}{logR}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{3}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:} array([ 21.88308304, 131.78438552,  38.2654605 ])
\end{Verbatim}
            
    \hypertarget{comments}{%
\subsection{Comments}\label{comments}}

Skewness are negative which means more returns are negative while normal
distribution is symetric.

Kurtosis are way higher than 3 indicating fatter tails than normal with
3 as kurtosis. However, the fourth moments may not be defined which
means kurtosis may eventually goes to infinity.

    \hypertarget{q-2}{%
\subsection{Q 2}\label{q-2}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{sort\PYZus{}LR} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{logR}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{logR}\PY{p}{:}
             \PY{n}{sort\PYZus{}LR}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{logR}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{values}
         \PY{n}{sort\PYZus{}LR}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}106}]:} \PY{k}{def} \PY{n+nf}{HS\PYZus{}var\PYZus{}ES}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{alpha\PYZus{}one}\PY{p}{,} \PY{n}{alpha\PYZus{}two}\PY{p}{,} \PY{n}{alpha\PYZus{}es}\PY{p}{)}\PY{p}{:}
              \PY{n}{ind\PYZus{}var\PYZus{}one} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(} \PY{n}{data}\PY{o}{.}\PY{n}{size} \PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{alpha\PYZus{}one}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
              \PY{n}{ind\PYZus{}var\PYZus{}two} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(} \PY{n}{data}\PY{o}{.}\PY{n}{size} \PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{alpha\PYZus{}two}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
              \PY{n}{ind\PYZus{}es} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(} \PY{n}{data}\PY{o}{.}\PY{n}{size} \PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{alpha\PYZus{}es}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
              \PY{n}{HS\PYZus{}var\PYZus{}ones} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{ind\PYZus{}var\PYZus{}one}\PY{p}{]}
              \PY{n}{HS\PYZus{}var\PYZus{}twos} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{ind\PYZus{}var\PYZus{}two}\PY{p}{]}
              \PY{n}{HS\PYZus{}ES} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{n}{ind\PYZus{}es}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
              
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Historical 5}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{ Var is : }\PY{l+s+si}{\PYZob{}HS\PYZus{}var\PYZus{}ones\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{c+c1}{\PYZsh{}print(f\PYZsq{}Historical \PYZob{}alpha\PYZus{}two * 100\PYZcb{}\PYZpc{} Var is : \PYZob{}HS\PYZus{}var\PYZus{}twos\PYZcb{}\PYZsq{})}
              \PY{c+c1}{\PYZsh{}print(f\PYZsq{}Historical \PYZob{}alpha\PYZus{}es * 100\PYZcb{}\PYZpc{} ES is : \PYZob{}HS\PYZus{}ES\PYZcb{}\PYZsq{})}
          
              \PY{k}{return} \PY{n}{HS\PYZus{}var\PYZus{}ones}
          
          \PY{c+c1}{\PYZsh{}In put is sorted (accending) log returns, when calculating var and ES, using floor of the index (size * alpha)}
          
          \PY{c+c1}{\PYZsh{}example for sorting}
          
          \PY{c+c1}{\PYZsh{}sortedreturn = np.asarray(np.sort(re20))}
          \PY{c+c1}{\PYZsh{}sortedreturn = np.asarray(logR.sort\PYZus{}values())}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sort\PYZus{}LR}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{For stock }\PY{l+s+si}{\PYZob{}col\PYZcb{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{HS\PYZus{}var\PYZus{}ES}\PY{p}{(}\PY{n}{sort\PYZus{}LR}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
For stock S1,
Historical 5\% Var is : -0.06415930785472801
For stock S2,
Historical 5\% Var is : -0.03722934176835602
For stock S3,
Historical 5\% Var is : -0.06178435253208292

    \end{Verbatim}

    To calculate HS var of \(\alpha\), you first calculate the array size *
\(\alpha\) = index, since this number is not generally integer, index
can be floored or capped. HS var can be difined as the index-th return
in a acending sorted reture series. It can also be difined as the meam
of these two.

The meanning of a x\% var is that, the futrue return with the same time
horizon will be equal or worse than this value with probability 1 - x\%

    \hypertarget{q3}{%
\subsection{Q3}\label{q3}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}93}]:} \PY{k+kn}{import} \PY{n+nn}{powerlaw}
         \PY{k}{def} \PY{n+nf}{get\PYZus{}alpha\PYZus{}and\PYZus{}start}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
             \PY{n}{fit} \PY{o}{=} \PY{n}{powerlaw}\PY{o}{.}\PY{n}{Fit}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{xmin}\PY{o}{=}\PY{n+nb}{min}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{,} \PY{n}{fit\PYZus{}method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Likelihood}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{alpha\PYZus{}expo} \PY{o}{=} \PY{n}{fit}\PY{o}{.}\PY{n}{power\PYZus{}law}\PY{o}{.}\PY{n}{alpha}
             \PY{n}{fit}\PY{o}{.}\PY{n}{power\PYZus{}law}\PY{o}{.}\PY{n}{plot\PYZus{}ccdf}
             \PY{n}{fit}\PY{o}{.}\PY{n}{plot\PYZus{}ccdf}
             \PY{k}{return} \PY{n}{alpha\PYZus{}expo}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
         
         \PY{k}{def} \PY{n+nf}{tail\PYZus{}expo\PYZus{}powerlaw}\PY{p}{(}\PY{n}{left\PYZus{}tail}\PY{p}{)}\PY{p}{:}
             \PY{n}{alphaL} \PY{o}{=} \PY{n}{get\PYZus{}alpha\PYZus{}and\PYZus{}start}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{left\PYZus{}tail}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tail exponent for the left tail is }\PY{l+s+si}{\PYZob{}alphaL\PYZcb{}}\PY{l+s+s1}{ based on max likelyhood estimation (using pythonpacage powerlaw)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             
             
             \PY{n}{left} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{flip}\PY{p}{(}\PY{n}{left\PYZus{}tail}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{values}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}right = pd.DataFrame(right\PYZus{}tail, columns=[\PYZsq{}x\PYZsq{}], dtype=float)}
             \PY{n}{domain} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n+nb}{min}\PY{p}{(}\PY{n}{left}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{max}\PY{p}{(}\PY{n}{left}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{)}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{loglog}\PY{p}{(}\PY{n}{left}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{left}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n}{left}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{+b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.loglog(right[\PYZsq{}x\PYZsq{}], 1 \PYZhy{} (range(1, right.count()[0] + 1))/(right.count()[0] + 1), \PYZsq{}xr\PYZsq{}, alpha = 0.5)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{loglog}\PY{p}{(}\PY{n}{domain}\PY{p}{,} \PY{p}{(}\PY{n}{domain}\PY{o}{*}\PY{l+m+mi}{15}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{alphaL}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}.b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.loglog(domain, (domain*110) ** (\PYZhy{}alphaR), \PYZsq{}\PYZhy{}.r\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}94}]:} \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sort\PYZus{}LR}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{For stock }\PY{l+s+si}{\PYZob{}col\PYZcb{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{left\PYZus{}tail} \PY{o}{=} \PY{n}{sort\PYZus{}LR}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{[}\PY{n}{sort\PYZus{}LR}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{HS\PYZus{}var\PYZus{}ES}\PY{p}{(}\PY{n}{sort\PYZus{}LR}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{)}\PY{p}{]}
             \PY{n}{tail\PYZus{}expo\PYZus{}powerlaw}\PY{p}{(}\PY{n}{left\PYZus{}tail}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
For stock S1,
Historical 5\% Var is : -0.06415930785472801
Tail exponent for the left tail is 2.093595854216556 based on max likelyhood estimation (using pythonpacage powerlaw)
For stock S2,
Historical 5\% Var is : -0.03722934176835602
Tail exponent for the left tail is 2.377002203068422 based on max likelyhood estimation (using pythonpacage powerlaw)
For stock S3,
Historical 5\% Var is : -0.06178435253208292
Tail exponent for the left tail is 1.809218385527358 based on max likelyhood estimation (using pythonpacage powerlaw)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/home/lin/.pyenv/versions/3.6.3/lib/python3.6/site-packages/powerlaw.py:697: RuntimeWarning: invalid value encountered in true\_divide
  (Theoretical\_CDF * (1 - Theoretical\_CDF))

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{q4}{%
\subsection{Q4}\label{q4}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}95}]:} \PY{k}{def} \PY{n+nf}{resample}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{days}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{:}
             \PY{n}{data} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{asarray}\PY{p}{(}\PY{n}{data}\PY{p}{)}
             \PY{n}{resampled} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{o}{/}\PY{n}{days}\PY{p}{)}\PY{p}{)}
             \PY{n}{j} \PY{o}{=} \PY{n}{days}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{resampled}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{n}{resampled}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{n}{j}\PY{o}{\PYZhy{}}\PY{n}{days}\PY{p}{:}\PY{n}{j}\PY{p}{]}\PY{p}{)}
                 \PY{n}{j} \PY{o}{=} \PY{n}{j} \PY{o}{+} \PY{n}{days}
             \PY{k}{return} \PY{n}{resampled}
         
         \PY{c+c1}{\PYZsh{}input is daily log return series}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}99}]:} \PY{n}{Yearly} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{logR}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{logR}\PY{p}{:}
             \PY{n}{Yearly}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{resample}\PY{p}{(}\PY{n}{logR}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,} \PY{n}{days}\PY{o}{=}\PY{l+m+mi}{250}\PY{p}{)}
         \PY{n}{Yearly}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}102}]:} \PY{n}{sort\PYZus{}LRY} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{Yearly}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{logR}\PY{p}{:}
              \PY{n}{sort\PYZus{}LRY}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{Yearly}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{values}
          \PY{n}{sort\PYZus{}LRY}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}107}]:} \PY{k}{def} \PY{n+nf}{HS\PYZus{}var\PYZus{}ESY}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{alpha\PYZus{}one}\PY{p}{,} \PY{n}{alpha\PYZus{}two}\PY{p}{,} \PY{n}{alpha\PYZus{}es}\PY{p}{)}\PY{p}{:}
              \PY{n}{ind\PYZus{}var\PYZus{}one} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(} \PY{n}{data}\PY{o}{.}\PY{n}{size} \PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{alpha\PYZus{}one}\PY{p}{)}\PY{p}{)}
              \PY{n}{ind\PYZus{}var\PYZus{}two} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(} \PY{n}{data}\PY{o}{.}\PY{n}{size} \PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{alpha\PYZus{}two}\PY{p}{)}\PY{p}{)}
              \PY{n}{ind\PYZus{}es} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(} \PY{n}{data}\PY{o}{.}\PY{n}{size} \PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{alpha\PYZus{}es}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
              \PY{n}{HS\PYZus{}var\PYZus{}ones} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{ind\PYZus{}var\PYZus{}one}\PY{p}{]}
              \PY{n}{HS\PYZus{}var\PYZus{}twos} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{ind\PYZus{}var\PYZus{}two}\PY{p}{]}
              \PY{n}{HS\PYZus{}ES} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{n}{ind\PYZus{}es}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
              
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Historical 5}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{ Var is : }\PY{l+s+si}{\PYZob{}HS\PYZus{}var\PYZus{}ones\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{c+c1}{\PYZsh{}print(f\PYZsq{}Historical \PYZob{}alpha\PYZus{}two * 100\PYZcb{}\PYZpc{} Var is : \PYZob{}HS\PYZus{}var\PYZus{}twos\PYZcb{}\PYZsq{})}
              \PY{c+c1}{\PYZsh{}print(f\PYZsq{}Historical \PYZob{}alpha\PYZus{}es * 100\PYZcb{}\PYZpc{} ES is : \PYZob{}HS\PYZus{}ES\PYZcb{}\PYZsq{})}
          
              \PY{k}{return} \PY{n}{HS\PYZus{}var\PYZus{}ones}
          
          \PY{c+c1}{\PYZsh{}In put is sorted (accending) log returns, when calculating var and ES, using floor of the index (size * alpha)}
          
          \PY{c+c1}{\PYZsh{}example for sorting}
          
          \PY{c+c1}{\PYZsh{}sortedreturn = np.asarray(np.sort(re20))}
          \PY{c+c1}{\PYZsh{}sortedreturn = np.asarray(logR.sort\PYZus{}values())}
\end{Verbatim}


    \hypertarget{diff-var-index-defined-as-cap-of-sizealpha}{%
\subsection{Diff : var index defined as cap of
size*alpha}\label{diff-var-index-defined-as-cap-of-sizealpha}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}117}]:} \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sort\PYZus{}LR}\PY{p}{:}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{For stock }\PY{l+s+si}{\PYZob{}col\PYZcb{}}\PY{l+s+s1}{ yearly return}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{HS\PYZus{}var\PYZus{}ESY}\PY{p}{(}\PY{n}{sort\PYZus{}LRY}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
For stock S1 yearly return
Historical 5\% Var is : -1.8605826910411751
For stock S2 yearly return
Historical 5\% Var is : -0.9472265321626683
For stock S3 yearly return
Historical 5\% Var is : -1.7044290620873686

    \end{Verbatim}

    For stock S1 daily return, Historical 5\% Var is : -0.06415930785472801
For stock S2 daily return, Historical 5\% Var is : -0.03722934176835602
For stock S3 daily return, Historical 5\% Var is : -0.06178435253208292

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}113}]:} \PY{n}{VarScaled\PYZus{}S1} \PY{o}{=} \PY{l+m+mi}{250} \PY{o}{*}\PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mf}{2.093595854216556}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.06415930785472801}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Scaled yearly Var for S1 is }\PY{l+s+si}{\PYZob{}VarScaled\PYZus{}S1\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Scaled yearly Var for S1 is -0.8966620198893082

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}115}]:} \PY{n}{VarScaled\PYZus{}S2} \PY{o}{=} \PY{l+m+mi}{250} \PY{o}{*}\PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mf}{2.377002203068422}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.03722934176835602}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Scaled yearly Var for S2 is }\PY{l+s+si}{\PYZob{}VarScaled\PYZus{}S2\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Scaled yearly Var for S2 is -0.3799214814641398

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}116}]:} \PY{n}{VarScaled\PYZus{}S3} \PY{o}{=} \PY{l+m+mi}{250} \PY{o}{*}\PY{o}{*} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mf}{1.809218385527358}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.06178435253208292}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Scaled yearly Var for S3 is }\PY{l+s+si}{\PYZob{}VarScaled\PYZus{}S3\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Scaled yearly Var for S3 is -1.307012025597282

    \end{Verbatim}

    Scaled Var have lower absolute value means they are not as save as HS
ones. However we can see that the lower the tail exponents, the fatter
tail it predict, and the higher losee it indicates, e.g.~S3

    \hypertarget{q5}{%
\subsection{Q5}\label{q5}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}118}]:} \PY{n}{logR}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}118}]:}                 S1           S2           S3
          count  2499.000000  2499.000000  2499.000000
          mean      0.000206    -0.000182    -0.000565
          std       0.045696     0.031346     0.054522
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}119}]:} \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{logR}\PY{p}{:}
              \PY{n}{a} \PY{o}{=} \PY{n}{logR}\PY{p}{[}\PY{n}{col}\PY{p}{]}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Log likelyhood for stock }\PY{l+s+si}{\PYZob{}col\PYZcb{}}\PY{l+s+s1}{ :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{b} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{stats}\PY{o}{.}\PY{n}{norm}\PY{o}{.}\PY{n}{pdf}\PY{p}{(}\PY{n}{a}\PY{p}{,} \PY{n}{loc} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{a}\PY{p}{)}\PY{p}{,} \PY{n}{scale} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{a}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{n}{b}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Log likelyhood for stock S1 :
4165.871528980833
Log likelyhood for stock S2 :
5107.753686042131
Log likelyhood for stock S3 :
3724.5310269669044

    \end{Verbatim}

    \hypertarget{q6}{%
\subsection{Q6}\label{q6}}

    \hypertarget{q7}{%
\subsection{Q7}\label{q7}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}120}]:} \PY{n}{corrcoeff} \PY{o}{=} \PY{n}{logR}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
          \PY{n}{corrcoeff}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}120}]:}           S1        S2        S3
          S1  1.000000  0.196510  0.297266
          S2  0.196510  1.000000  0.238568
          S3  0.297266  0.238568  1.000000
\end{Verbatim}
            
    Most correlated pair is S1 and S3 with correlation 0.297266

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}124}]:} \PY{n}{KenTau} \PY{o}{=} \PY{n}{logR}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kendall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{KenTau}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}124}]:}           S1        S2        S3
          S1  1.000000  0.204007  0.248653
          S2  0.204007  1.000000  0.263681
          S3  0.248653  0.263681  1.000000
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}125}]:} \PY{n}{spearmanRank} \PY{o}{=} \PY{n}{logR}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{spearmanRank}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}125}]:}           S1        S2        S3
          S1  1.000000  0.294712  0.347430
          S2  0.294712  1.000000  0.374042
          S3  0.347430  0.374042  1.000000
\end{Verbatim}
            
    These two agreed with that most correlated pair is S2 and S3 which are
diff form Pearson. Potential reasons are 1) These two capture non-linear
correlations that Pearson does not capture 2) these two capture only
monotonic correlations

For all three type of correlations, all correlations are positive

    \hypertarget{q8}{%
\subsection{Q8}\label{q8}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}133}]:} \PY{n}{R\PYZus{}Port} \PY{o}{=} \PY{n}{logR}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{l+m+mf}{0.297266} \PY{o}{*} \PY{p}{(}\PY{l+m+mf}{0.045696} \PY{o}{/} \PY{l+m+mf}{0.054522}\PY{p}{)} \PY{o}{*} \PY{n}{logR}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean return of this portfolio is }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{R\PYZus{}Port}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Mean return of this portfolio is 

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}133}]:} 0.00034691440498137827
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}134}]:} \PY{n}{SortPort} \PY{o}{=} \PY{n}{R\PYZus{}Port}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}136}]:} \PY{n}{SortPort}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}136}]:} 0      -0.458405
          1      -0.336894
          2      -0.279572
          3      -0.243253
          4      -0.219205
          5      -0.218581
          6      -0.216567
          7      -0.204693
          8      -0.189592
          9      -0.171364
          10     -0.168541
          11     -0.167035
          12     -0.164339
          13     -0.162952
          14     -0.159540
          15     -0.158301
          16     -0.151918
          17     -0.149789
          18     -0.140624
          19     -0.140105
          20     -0.134969
          21     -0.131436
          22     -0.131292
          23     -0.131154
          24     -0.130966
          25     -0.128006
          26     -0.126725
          27     -0.124037
          28     -0.123290
          29     -0.123143
                    {\ldots}   
          2469    0.115284
          2470    0.117585
          2471    0.117822
          2472    0.119394
          2473    0.121088
          2474    0.122997
          2475    0.124338
          2476    0.125237
          2477    0.127945
          2478    0.129148
          2479    0.129395
          2480    0.129438
          2481    0.131391
          2482    0.141639
          2483    0.145360
          2484    0.149205
          2485    0.154092
          2486    0.159307
          2487    0.160251
          2488    0.162897
          2489    0.166323
          2490    0.169750
          2491    0.182962
          2492    0.208313
          2493    0.212509
          2494    0.218125
          2495    0.278788
          2496    0.290148
          2497    0.358988
          2498    0.524773
          Length: 2499, dtype: float64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}140}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{For portfolio,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{c} \PY{o}{=} \PY{n}{HS\PYZus{}var\PYZus{}ES}\PY{p}{(}\PY{n}{SortPort}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
For portfolio,
Historical 5\% Var is : -0.05816242305521469

    \end{Verbatim}

    For stock S1, Historical 5\% Var is : -0.06415930785472801

Confirmed the portfolio has lower absolute value of Var5\%

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{bootstrap\PYZus{}test}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pearson}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{times}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}\PY{p}{:}
            
            \PY{n}{realCorr} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{n}{method}\PY{p}{)}
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{realCorr}\PY{p}{)}
            \PY{n}{permuted} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
            \PY{n}{counts} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
            \PY{n}{minCorr} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
            \PY{n}{maxCorr} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
        
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
                \PY{n}{one\PYZus{}update} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
        
                \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{data}\PY{p}{:}
                    \PY{n}{permuted}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{replace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                \PY{n}{ranCorr} \PY{o}{=} \PY{n}{permuted}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method} \PY{o}{=} \PY{n}{method}\PY{p}{)}
        
                \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{ranCorr}\PY{p}{:}
                    \PY{k}{for} \PY{n}{ref\PYZus{}col} \PY{o+ow}{in} \PY{n}{ranCorr}\PY{p}{:}
                        \PY{k}{if} \PY{n}{ranCorr}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{[}\PY{n}{ref\PYZus{}col}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{realCorr}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{[}\PY{n}{ref\PYZus{}col}\PY{p}{]}\PY{p}{:}
                            \PY{n}{one\PYZus{}update}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{[}\PY{n}{ref\PYZus{}col}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
                        \PY{k}{if} \PY{n}{ranCorr}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{[}\PY{n}{ref\PYZus{}col}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{minCorr}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{[}\PY{n}{ref\PYZus{}col}\PY{p}{]}\PY{p}{:}
                            \PY{n}{minCorr}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{[}\PY{n}{ref\PYZus{}col}\PY{p}{]} \PY{o}{=} \PY{n}{ranCorr}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{[}\PY{n}{ref\PYZus{}col}\PY{p}{]}
                        \PY{k}{if} \PY{n}{ranCorr}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{[}\PY{n}{ref\PYZus{}col}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{maxCorr}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{[}\PY{n}{ref\PYZus{}col}\PY{p}{]}\PY{p}{:}
                            \PY{n}{maxCorr}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{[}\PY{n}{ref\PYZus{}col}\PY{p}{]} \PY{o}{=} \PY{n}{ranCorr}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{[}\PY{n}{ref\PYZus{}col}\PY{p}{]}
                            
                \PY{c+c1}{\PYZsh{}print(one\PYZus{}update)}
                \PY{n}{counts} \PY{o}{=} \PY{n}{counts} \PY{o}{+} \PY{n}{one\PYZus{}update}
                
            \PY{k}{return} \PY{n}{counts}\PY{o}{/}\PY{n}{times}\PY{p}{,} \PY{n}{maxCorr}\PY{p}{,} \PY{n}{minCorr}
        
            
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{bootstrap\PYZus{}test}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pearson}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{times}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{)}\PY{p}{:}
            \PY{n}{Boot} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
            \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
                \PY{n}{Boot}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{replace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
            \PY{n}{R\PYZus{}Port} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{Boot}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{*} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{o}{*} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}



    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
